# Configuration Hyprland équivalente à Sway
# Basée sur la configuration Sway existante

# Variables
$mod = SUPER
$alt = ALT
$left = h
$down = j
$up = k
$right = l
$term = ghostty
$menu = rofi -show drun

# Moniteurs et configuration d'affichage
monitor = DP-1, preferred, auto, 1
monitor = eDP-1, preferred, auto, 1

# Focus sur DP-1 au démarrage
exec-once = sleep 2 && hyprctl dispatch focusmonitor DP-1

# Gestion du laptop (clamshell mode)
# Note: Hyprland gère automatiquement les laptops fermés
bindl = , switch:on:Lid Switch, exec, hyprctl keyword monitor "eDP-1, disable"
bindl = , switch:off:Lid Switch, exec, hyprctl keyword monitor "eDP-1, preferred, auto, 1"

# Applications de démarrage
exec-once = swaync
exec-once = systemctl --user import-environment DISPLAY WAYLAND_DISPLAY
exec-once = dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY
exec-once = sleep 2 && hyprctl dispatch workspace 1

# Variables d'environnement
env = XCURSOR_SIZE, 24

# Configuration générale
general {
    gaps_in = 1
    gaps_out = 0
    border_size = 1
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    layout = dwindle
    allow_tearing = false
}

# Décoration
decoration {
    rounding = 10
    blur {
        enabled = true
        size = 3
        passes = 1
    }
    # drop_shadow = yes
    # shadow_range = 4
    # shadow_render_power = 3
    # col.shadow = rgba(1a1a1aee)
}

# Animations
animations {
    enabled = yes
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

# Layout dwindle
dwindle {
    pseudotile = yes
    preserve_split = yes
}

# Layout master
master {
    # new_is_master = true
}

# Gestures
gestures {
    workspace_swipe = off
}

# Configuration des périphériques d'entrée
input {
    kb_layout = fr
    kb_variant =
    kb_model =
    kb_options =
    kb_rules =
    
    follow_mouse = 1
    
    touchpad {
        natural_scroll = yes
        tap-to-click = yes
    }
    
    sensitivity = 0
}

# Règles de fenêtres
windowrulev2 = float, class:^(flameshot)$
# windowrulev2 = nofullscreenrequest, class:^(flameshot)$
windowrulev2 = move 0 0, class:^(flameshot)$
windowrulev2 = noborder, class:^(flameshot)$

windowrulev2 = float, class:^(xdg-desktop-portal-gtk)$
windowrulev2 = size 700 800, class:^(xdg-desktop-portal-gtk)$

# Fond d'écran
exec-once = swaybg -i ~/.config/sway/montagne.jpg -m fill

# Raccourcis clavier de base
bind = $mod, Return, exec, $term
bind = $mod SHIFT, q, killactive,
bind = $mod, d, exec, $menu
bind = $mod SHIFT, e, exec, swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit Hyprland?' -B 'Yes, exit' 'hyprctl dispatch exit'

# Contrôles audio
binde = , XF86AudioRaiseVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ +5%
binde = , XF86AudioLowerVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ -5%
bind = , XF86AudioMute, exec, pactl set-sink-mute @DEFAULT_SINK@ toggle

# Contrôles de luminosité
binde = , XF86MonBrightnessUp, exec, light -A 10
binde = , XF86MonBrightnessDown, exec, light -U 10

# Screenshots
bind = $mod, p, exec, grim -g "$(slurp)" - | swappy -f -
bind = $mod SHIFT, p, exec, grim -o $(hyprctl monitors -j | jq -r '.[] | select(.focused) | .name') - | wl-copy

# Verrouillage d'écran
bind = $mod, l, exec, swaylock -f -i ~/.config/sway/montagne.jpg -s fill

# Notifications
bind = $mod SHIFT, n, exec, swaync-client -t -sw

# Navigation entre les fenêtres
bind = $alt, $left, movefocus, l
bind = $alt, $down, movefocus, d
bind = $alt, $up, movefocus, u
bind = $alt, $right, movefocus, r

# Navigation avec les flèches
bind = $mod, left, movefocus, l
bind = $mod, down, movefocus, d
bind = $mod, up, movefocus, u
bind = $mod, right, movefocus, r

# Déplacer les fenêtres
bind = $mod SHIFT, $left, movewindow, l
bind = $mod SHIFT, $down, movewindow, d
bind = $mod SHIFT, $up, movewindow, u
bind = $mod SHIFT, $right, movewindow, r

# Déplacer avec les flèches
bind = $mod SHIFT, left, movewindow, l
bind = $mod SHIFT, down, movewindow, d
bind = $mod SHIFT, up, movewindow, u
bind = $mod SHIFT, right, movewindow, r

# Espaces de travail (utilisation des caractères français)
bind = $mod, ampersand, workspace, 1
bind = $mod, eacute, workspace, 2
bind = $mod, quotedbl, workspace, 3
bind = $mod, apostrophe, workspace, 4
bind = $mod, parenleft, workspace, 5
bind = $mod, minus, workspace, 6
bind = $mod, egrave, workspace, 7
bind = $mod, underscore, workspace, 8
bind = $mod, ccedilla, workspace, 9
bind = $mod, agrave, workspace, 10

# Déplacer vers les espaces de travail
bind = $mod SHIFT, ampersand, movetoworkspace, 1
bind = $mod SHIFT, eacute, movetoworkspace, 2
bind = $mod SHIFT, quotedbl, movetoworkspace, 3
bind = $mod SHIFT, apostrophe, movetoworkspace, 4
bind = $mod SHIFT, parenleft, movetoworkspace, 5
bind = $mod SHIFT, minus, movetoworkspace, 6
bind = $mod SHIFT, egrave, movetoworkspace, 7
bind = $mod SHIFT, underscore, movetoworkspace, 8
bind = $mod SHIFT, ccedilla, movetoworkspace, 9
bind = $mod SHIFT, agrave, movetoworkspace, 10

# Layouts
bind = $mod, b, layoutmsg, orientationnext
bind = $mod, v, layoutmsg, orientationprev
bind = $mod, s, exec, hyprctl keyword general:layout "master"
bind = $mod, w, togglegroup
bind = $mod, e, layoutmsg, togglesplit

# Plein écran
bind = $mod, f, fullscreen,

# Flottant
bind = $mod SHIFT, space, togglefloating,
bind = $mod, space, focusurgentorlast,

# Focus parent (approximation)
bind = $mod, a, focusurgentorlast,

# Scratchpad (utilisation de special workspace)
bind = $mod SHIFT, equal, movetoworkspace, special
bind = $mod, equal, togglespecialworkspace,

# Mode redimensionnement
bind = $mod, r, submap, resize
submap = resize

binde = , $right, resizeactive, 10 0
binde = , $left, resizeactive, -10 0
binde = , $up, resizeactive, 0 -10
binde = , $down, resizeactive, 0 10

binde = , right, resizeactive, 10 0
binde = , left, resizeactive, -10 0
binde = , up, resizeactive, 0 -10
binde = , down, resizeactive, 0 10

bind = , escape, submap, reset
bind = , return, submap, reset
submap = reset

# # Mode souris (simulation)
# bind = $mod, g, exec, wl-kbptr -o modes=floating,click -o mode_floating.source=detect
# bind = $mod SHIFT, g, submap, mouse
# submap = mouse
#
# bind = , a, exec, wl-kbptr-sway-active-win
# bind = , a, submap, reset
# bind = SHIFT, a, exec, wl-kbptr
# bind = SHIFT, a, submap, reset
#
# # Navigation souris
# bind = , $left, exec, wl-kbptr --move -15 0
# bind = , $down, exec, wl-kbptr --move 0 15
# bind = , $up, exec, wl-kbptr --move 0 -15
# bind = , $right, exec, wl-kbptr --move 15 0
#
# # Clics souris (approximation avec wl-kbptr)
# bind = , g, exec, wl-kbptr --click left
# bind = , d, exec, wl-kbptr --click middle
# bind = , f, exec, wl-kbptr --click right
#
# bind = , escape, submap, reset
# submap = reset

# Défilement de la souris pour changer d'espace de travail
bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up, workspace, e-1

# Déplacement de fenêtre avec la souris
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow

# Barre de statut (waybar)
exec-once = waybar

